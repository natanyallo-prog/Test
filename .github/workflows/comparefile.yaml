name: Compare files with repo variable and secret

on:
  workflow_dispatch:

jobs:
  compare_with_variable:
    name: Job 1 - Compare file with repository variable
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Compare class.txt with repository variable
        env:
          REPO_VAR: ${{ vars.NathanK }}
        run: |
          FILE_VALUE=$(cat class.txt)

          if [ "$FILE_VALUE" != "$REPO_VAR" ]; then
            echo "‚ùå class.txt does not match repository variable NathanK"
            exit 0
          fi

          echo "‚úÖ class.txt matches repository variable NathanK"

  compare_with_secret:
    name: Job 2 - Compare file with secret
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Compare secret file with secret
        env:
          SECRET_VALUE: ${{ secrets.MY_SECRET }}
        run: |
          FILE_VALUE=$(cat class.txt)

          if [ "$FILE_VALUE" != "$SECRET_VALUE" ]; then
            echo "‚ùå Secret file does not match secret"
            exit 0
          fi

          echo "‚úÖ Secret file matches secret"

  success_job:
    name: Job 3 - Run only if Job 1 and Job 2 succeed
    runs-on: ubuntu-latest
    needs:
      - compare_with_variable
      - compare_with_secret

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Print safe values and confirm success
        env:
          REPO_VAR: ${{ vars.NathanK }}
        run: |
          FILE_VALUE=$(cat class.txt)

          echo "üéâ All checks passed"

